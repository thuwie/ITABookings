{% block body %}
<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Đặt xe</title>

  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css" rel="stylesheet">
  <style>
    body {
      background: #eef2f7;
      font-family: Arial;
      padding-bottom: 40px;
    }
    .box {
      background: #fff;
      padding: 25px;
      border-radius: 12px;
      box-shadow: 0 0 10px rgba(0,0,0,0.12);
      margin-bottom: 25px;
    }
    .title {
      color: #002b5c;
      font-weight: bold;
      margin-bottom: 15px;
      border-bottom: 2px solid #d3d7de;
      padding-bottom: 5px;
    }
    .btn-main {
      background: #002b5c;
      color: #fff;
      font-weight: bold;
    }
    .btn-main:hover {
      background: #004080;
    }
    .vehicle-img {
      width: 100%;
      border-radius: 10px;
      height: 190px;
      object-fit: cover;
    }
    .cost-line {
      display: flex;
      justify-content: space-between;
      margin-bottom: 8px;
      font-size: 15px;
    }
    .total {
      font-size: 22px;
      color: #002b5c;
      font-weight: bold;
    }
  </style>
</head>

<body>

<div class="container py-4">

  <!-- PHƯƠNG TIỆN -->
  <div class="box">
    <h4 class="title">Thông tin phương tiện</h4>

    <div class="row">
      <div class="col-md-4">
        <img src="car.jpg" class="vehicle-img" alt="Xe">
      </div>
      <div class="col-md-8">
        <p><b>Hãng xe:</b> Toyota</p>
        <p><b>Dòng xe:</b> Vios 2020</p>
        <p><b>Số chỗ:</b> 4 chỗ</p>
        <p><b>Biển số:</b> 30A-123.45</p>
        <p><b>Giá mặc định / ngày:</b> 500.000đ</p>
      </div>
    </div>
  </div>

  <!-- NHÀ CUNG CẤP -->
  <div class="box">
    <h4 class="title">Thông tin nhà cung cấp</h4>
    <p><b>Tên nhà cung cấp:</b> Công ty ABC Transport</p>
    <p><b>Điện thoại:</b> 0902 333 444</p>
    <p><b>Địa chỉ:</b> 12 Nguyễn Trãi, Hà Nội</p>
  </div>

  <!-- USER -->
  <div class="box">
    <h4 class="title">Thông tin người đặt (tự động lấy từ tài khoản)</h4>
    <p><b>Họ tên:</b> Nguyễn Văn A</p>
    <p><b>Email:</b> user@gmail.com</p>
    <p><b>SĐT:</b> 0987654321</p>
  </div>

  <!-- ĐIỂM ĐÓN / ĐI -->
  <div class="box">
    <h4 class="title">Hành trình</h4>

    <p><b>Điểm đón:</b> 123 Lê Duẩn, Hà Nội</p>
    <p><b>Điểm đến:</b> 45 Cầu Giấy, Hà Nội</p>

    <div class="row mt-3">
      <div class="col-md-6">
        <label>Ngày đi</label>
        <input type="date" id="startDate" class="form-control">
      </div>
      <div class="col-md-6">
        <label>Ngày về</label>
        <input type="date" id="endDate" class="form-control">
      </div>
    </div>

    <!-- BOOK TÀI XẾ -->
    <div class="mt-3">
      <label><b>Bạn có muốn book tài xế?</b></label>
      <select id="driver" class="form-select mt-1">
        <option value="no">Không</option>
        <option value="yes">Có (+200.000đ/ngày)</option>
      </select>
    </div>

  </div>

  <!-- TÍNH GIÁ -->
  <div class="box">
    <h4 class="title">Chi phí</h4>

    <div class="cost-line">
      <span>Giá mặc định / ngày:</span>
      <span id="basePrice">500.000đ</span>
    </div>

    <div class="cost-line">
      <span>Phụ phí tài xế:</span>
      <span id="driverCost">0đ</span>
    </div>

    <div class="cost-line">
      <span>Tổng số ngày:</span>
      <span id="days">0 ngày</span>
    </div>

    <hr>

    <div class="cost-line total">
      <span>Tổng thanh toán:</span>
      <span id="total">0đ</span>
    </div>

  </div>

  <!-- ACTION BUTTONS -->
  <div class="d-flex justify-content-between">
    <a href="search.html" class="btn btn-secondary px-4">Hủy</a>
    <a href="car_detail.html" class="btn btn-main px-4" onclick="saveBooking()">Xác nhận đặt xe</a>
  </div>

</div>

<script>
  function calculate() {
    let base = 500000;
    let driverPerDay = 200000;

    const start = new Date(document.getElementById("startDate").value);
    const end = new Date(document.getElementById("endDate").value);

    let days = (end - start) / (1000 * 60 * 60 * 24);
    if (days < 1) days = 0;

    document.getElementById("days").innerText = days + " ngày";

    const hasDriver = document.getElementById("driver").value === "yes";
    const driverFee = hasDriver ? driverPerDay * days : 0;

    document.getElementById("driverCost").innerText = driverFee.toLocaleString() + "đ";

    const total = days * base + driverFee;
    document.getElementById("total").innerText = total.toLocaleString() + "đ";
  }

  document.getElementById("startDate").addEventListener("change", calculate);
  document.getElementById("endDate").addEventListener("change", calculate);
  document.getElementById("driver").addEventListener("change", calculate);

function saveBooking() {
  const booking = {
    carBrand: "Toyota",
    carModel: "Vios 2020",
    seats: "4 chỗ",
    licensePlate: "30A-123.45",
    basePrice: 500000,

    supplierName: "Công ty ABC Transport",
    supplierPhone: "0902 333 444",
    supplierAddress: "12 Nguyễn Trãi, Hà Nội",

    userName: "Nguyễn Văn A",
    userEmail: "user@gmail.com",
    userPhone: "0987654321",

    pickup: "123 Lê Duẩn, Hà Nội",
    dropoff: "45 Cầu Giấy, Hà Nội",

    startDate: document.getElementById("startDate").value,
    endDate: document.getElementById("endDate").value,
    driver: document.getElementById("driver").value,
    totalPrice: document.getElementById("total").innerText,
    days: document.getElementById("days").innerText
  };

  localStorage.setItem("bookingData", JSON.stringify(booking));
}
</script>

</body>
</html>
{% endblock %}